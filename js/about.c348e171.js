"use strict";(self["webpackChunksouther_cotizaciones"]=self["webpackChunksouther_cotizaciones"]||[]).push([[443],{6563:function(e,t,o){o.r(t),o.d(t,{default:function(){return x}});var s=o(831),r=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("input",{attrs:{id:"input",type:"file"},on:{change:function(t){return e.uploadExcelFile(t)}}}),e.firstWorksheet?t(s.Z,{attrs:{color:"primary"},on:{click:e.handleDownloadExcel}},[e._v(" Download ")]):e._e()],1),t("div",{staticClass:"overflow-auto"},[t("table",{staticClass:"sheet-table caption",attrs:{id:"Table2XLSX"}},[t("tbody",[e._l(e.sheetRowsTender,(function(o,s){return[t("WorkSheetTenderRow",{key:`tender_${s}`,attrs:{"row-data":o,"worksheet-ref":e.firstWorksheetRef}})]})),e._l(e.sheetRowsProviders,(function(o,s){return[t("WorkSheetProviderRow",{key:`provider_${s}`,attrs:{"row-data":o,"worksheet-ref":e.firstWorksheetRef},on:{"edit:factor-landed":function(t){return e.handleEditFactorLanded(t)}}})]})),e._l(e.sheetRowsProducts,(function(o,s){return[t("WorkSheetProductRow",{key:`product_${s}`,attrs:{"row-data":o,"worksheet-ref":e.firstWorksheetRef}})]}))],2)])]),e.cellDataToEdit?t("CellModalEdit",{attrs:{item:e.cellDataToEdit},on:{"click:edit-cell":e.handleSaveEditFactorLanded},model:{value:e.showCellModalEdit,callback:function(t){e.showCellModalEdit=t},expression:"showCellModalEdit"}}):e._e()],1)},l=[],i=o(1799),a=o(9818),d=o(8942),h=o(9854),n=o(6888),c=o(2063),u=o(7765),w=o(3461),f=o(1958),k=o(1147),R=o(9679),W=o(2459),_={name:"HomeView",components:{WorkSheetTenderRow:i.Z,WorkSheetProductRow:d.Z,WorkSheetProviderRow:a.Z,CellModalEdit:h.Z},data(){return{excelData:[],excelFile:null,sheetRows:[],sheetRowsTender:[],sheetRowsProviders:[],sheetRowsProducts:[],firstWorksheet:null,firstWorksheetRows:[],firstWorksheetRef:null,showCellModalEdit:!1,cellDataToEdit:null}},methods:{uploadExcelFile(e){const t=e.target.files[0],o=new FileReader;o.onload=()=>{const e=o.result,t=(0,W.read)(e),s=t.Sheets[t.SheetNames[0]],r=W.utils.sheet_to_json(s,{header:1,nullError:!0}),l=(0,n.Z)(r),i=W.utils.aoa_to_sheet(l);this.createNewWorksheet(i)},o.readAsArrayBuffer(t)},createNewWorksheet(e){this.firstWorksheetRows=W.utils.sheet_to_json(e,{header:1,nullError:!0});const t=W.utils.decode_range(e["!ref"]||"A1");this.firstWorksheetRef={ref:e["!ref"],cols:t.e.c,rows:t.e.r},this.firstWorksheetRows=(0,k.Z)(this.firstWorksheetRows);const o=(0,c.Z)(this.firstWorksheetRows,t.e.c);this.sheetRowsTender=(0,u.Z)(o),this.sheetRowsProducts=(0,f.Z)(o),this.sheetRowsProviders=(0,w.Z)(o,this.sheetRowsProducts),this.firstWorksheet=e},handleDownloadExcel(){const e=W.utils.book_new();W.utils.book_append_sheet(e,this.firstWorksheet,"Sheet1"),(0,W.writeFile)(e,"souther_xxx.xlsx")},handleEditFactorLanded(e){this.cellDataToEdit=e,this.showCellModalEdit=!0},handleSaveEditFactorLanded(e){const t=W.utils.encode_cell({r:e.rowIndex,c:e.colIndex});this.firstWorksheet[t].v=e.value;const o=(0,R.Z)(this.sheetRowsProducts,e.providerId-1,e.value);o.forEach(((e,t)=>{const o=W.utils.encode_cell({r:e.rowIndex,c:e.colIndex});this.firstWorksheet[o].v=e.value})),this.createNewWorksheet(this.firstWorksheet),this.cellDataToEdit=null,this.showCellModalEdit=!1}}},E=_,v=o(1001),p=(0,v.Z)(E,r,l,!1,null,"0e97987e",null),x=p.exports}}]);
//# sourceMappingURL=about.c348e171.js.map